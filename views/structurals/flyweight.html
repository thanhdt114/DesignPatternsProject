<section id="flyweight">
    <div class="child-content">
        <h2>Flyweight</h2>
        <h3>Định nghĩa</h3>
        <p>
            Mẫu Flyweight trong design pattern là một mẫu thiết kế cấu trúc, được sử dụng để giảm
            thiểu việc sử dụng bộ nhớ bằng cách chia sẻ các đối tượng giống nhau giữa nhiều đối
            tượng khác nhau. Mục tiêu của mẫu Flyweight là tối ưu hóa sử dụng bộ nhớ và cải thiện
            hiệu suất bằng cách chia sẻ các thông tin chung giữa các đối tượng.
            <br /><br />
            Trong mẫu Flyweight, có hai loại đối tượng: Flyweight và Context. Flyweight chứa các
            thông tin chung được chia sẻ giữa các đối tượng, trong khi Context chứa thông tin cần
            thiết để định danh và tùy chỉnh các đối tượng.
        </p>

        <h3>Class diagram</h3>
        <img src="creationals/image/class-diagram-flyweight" alt="class-diagram-flyweight" />

        <h3>Code ví dụ</h3>
        <pre class="code-container">
            <code>
    // Flyweight
    class CoffeeFlavor {
        constructor(flavor) {
            this.flavor = flavor;
        }
    
        getFlavor() {
            return this.flavor;
        }
    }
    
    // Flyweight Factory
    class CoffeeFlavorFactory {
        constructor() {
            this.flavors = {};
        }
    
        getCoffeeFlavor(flavorName) {
            if (!this.flavors[flavorName]) {
                this.flavors[flavorName] = new CoffeeFlavor(flavorName);
            }
            return this.flavors[flavorName];
        }
    
        getTotalCoffeeFlavors() {
            return Object.keys(this.flavors).length;
        }
    }
    
    // Usage
    const flavors = ["Espresso", "Cappuccino", "Latte", "Mocha"];
    const factory = new CoffeeFlavorFactory();
    
    flavors.forEach((flavor) => {
        const coffeeFlavor = factory.getCoffeeFlavor(flavor);
        console.log(`Coffee Flavor: ${coffeeFlavor.getFlavor()}`);
    });
    
    console.log(`Total Coffee Flavors: ${factory.getTotalCoffeeFlavors()}`);
    // Output:
    // Coffee Flavor: Espresso
    // Coffee Flavor: Cappuccino
    // Coffee Flavor: Latte
    // Coffee Flavor: Mocha
    // Total Coffee Flavors: 4                
            </code>
        </pre>

        <h3>Giải thích code</h3>
        <p>
            Trong ví dụ trên, chúng ta có hai loại đối tượng: CoffeeFlavor (Flyweight) và
            CoffeeFlavorFactory (Flyweight Factory).
            <br /><br />
            Lớp CoffeeFlavor đại diện cho một hương vị cà phê. Mỗi đối tượng CoffeeFlavor chứa thông
            tin về hương vị và có thể được chia sẻ giữa nhiều đối tượng khác nhau.
            <br /><br />
            Lớp CoffeeFlavorFactory là một Factory, chịu trách nhiệm quản lý và cung cấp các đối
            tượng CoffeeFlavor. Nếu một hương vị cà phê đã tồn tại, Factory sẽ trả về đối tượng đã
            được tạo trước đó, ngược lại, nó sẽ tạo một đối tượng mới và lưu trữ vào bộ nhớ để sử
            dụng lại.
            <br /><br />
            Khi chúng ta sử dụng các đối tượng CoffeeFlavor từ Factory, chúng ta chỉ cần tham chiếu
            đến đối tượng đã có thay vì tạo một đối tượng mới. Điều này giúp giảm sự sử dụng bộ nhớ
            và tối ưu hóa việc tạo đối tượng.
            <br /><br />
            Trong ví dụ, chúng ta tạo ra các đối tượng CoffeeFlavor cho các hương vị cà phê khác
            nhau. Mỗi lần tạo đối tượng, Factory kiểm tra xem đối tượng đã tồn tại hay chưa. Cuối
            cùng, chúng ta in ra số lượng hương vị cà phê đã được tạo bởi Factory.
        </p>

        <div class="apply">
            <button onclick="processFlyweight()">Create</button>
            <button onclick="clearState()">Clear State</button>
        </div>

        <div class="state">
            <p id="now-state">State: empty</p>
        </div>

        <div class="result"></div>
    </div>
</section>
